# Development Dockerfile with hot reload support

# Backend development
FROM node:20-alpine AS backend-dev
WORKDIR /app
COPY package*.json ./
COPY packages/backend/package.json ./packages/backend/
COPY packages/shared/package.json ./packages/shared/
RUN npm ci
COPY tsconfig.json ./
COPY packages/shared ./packages/shared
COPY packages/backend ./packages/backend
RUN npm run build --workspace=@resonance/shared
EXPOSE 3000
CMD ["npm", "run", "dev", "--workspace=@resonance/backend"]

# Frontend development
FROM node:20-alpine AS frontend-dev
WORKDIR /app
COPY package*.json ./
COPY packages/frontend/package.json ./packages/frontend/
COPY packages/shared/package.json ./packages/shared/
RUN npm ci
COPY tsconfig.json ./
COPY packages/shared ./packages/shared
COPY packages/frontend ./packages/frontend
RUN npm run build --workspace=@resonance/shared
EXPOSE 5173
CMD ["npm", "run", "dev", "--workspace=@resonance/frontend", "--", "--host"]
